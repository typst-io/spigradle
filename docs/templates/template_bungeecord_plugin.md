# Bungeecord Plugin

The [Bungeecord](https://www.spigotmc.org/wiki/about-bungeecord/) plugin allows you to:

- Generate 'bungee.yml' with less configuration.

- Shortcuts for dependency and repository.

## Table of contents

- [Requirements](#requirements)

- [Usage](#usage)

- [Description file generation](#description-file-generation)

- [Main class detection](#main-class-detection)

- [Configuration](#configuration)

- [Tasks](#tasks)

- [See also](#see-also)

## Requirements

The plugin requires Gradle 8.0+, the latest version is recommended.

To update your gradle wrapper:

```
gradlew wrapper --gradle-version $GRADLE_VERSION --distribution-type all
```

## Usage

[Full Example Here](https://github.com/spigradle/spigradle-sample/tree/master/bungeecord)

### Using Version Catalog (Recommended)

**settings.gradle.kts**
```kotlin
dependencyResolutionManagement {
    repositories {
        mavenCentral()
    }
    versionCatalogs {
        create("bungees") {
            from("io.typst:bungee-catalog:$SPIGRADLE_VERSION")
        }
    }
}
```

**build.gradle.kts**
```kotlin
plugins {
    java
    alias(bungees.plugins.bungee)
}

repositories {
    mavenCentral()
    bungeeRepos {
        bungeecord()
    }
}

dependencies {
    compileOnly(bungees.bungeecord.api)
}
```

<details>
<summary>Groovy (settings.gradle)</summary>

```groovy
dependencyResolutionManagement {
    repositories {
        mavenCentral()
    }
    versionCatalogs {
        create('bungees') {
            from('io.typst:bungee-catalog:$SPIGRADLE_VERSION')
        }
    }
}
```

</details>

<details>
<summary>Groovy (build.gradle)</summary>

```groovy
plugins {
    id 'java'
    alias bungees.plugins.bungee
}

repositories {
    mavenCentral()
    bungeeRepos {
        bungeecord()
    }
}

dependencies {
    compileOnly bungees.bungeecord.api
}
```

</details>

### Without Version Catalog

**Groovy DSL**
```groovy
plugins {
    id 'io.typst.spigradle.bungee' version '$SPIGRADLE_VERSION'
}
```

**Kotlin DSL**
```kotlin
plugins {
    id("io.typst.spigradle.bungee") version "$SPIGRADLE_VERSION"
}
```

## Description file generation

The `bungee.yml` file will be generated by task `generateBungeeDescription` based on the [configuration of `bungee`](#configuration), included into output jars automatically.

Basically the properties 'main', 'name' and 'version' defaults to [auto-detected main](#main-class-detection), [project.name](https://docs.gradle.org/current/javadoc/org/gradle/api/Project.html#getName--), [project.version](https://docs.gradle.org/current/javadoc/org/gradle/api/Project.html#getName--) respectively.  So if we create a simple plugin that just needs those properties, we don't need any configuration. Only pay attention to your unique implementation.

You can configure all properties of `plugin.yml` in [bungee {} block](#configuration).

## Main class detection

The plugin automatically detects your main plugin class using bytecode analysis (ASM). It scans compiled `.class` files to find classes that extend [Plugin](https://ci.md-5.net/job/BungeeCord/ws/api/target/apidocs/net/md_5/bungee/api/plugin/Plugin.html).

**How it works:**
- Scans compiled bytecode (not source code) for faster and more reliable detection
- Finds non-abstract, public classes extending `net.md_5.bungee.api.plugin.Plugin`
- Supports complex inheritance hierarchies
- Incremental: only scans changed files for faster builds
- Automatically sets the `main` property in `bungee.yml`

**Manual override:**
If you need to manually specify the main class:
```groovy
bungee {
    main.set("com.example.MyCustomMain")
}
```

For more details, see the [Main Class Detection](../README.md#main-class-detection) section.

## Configuration

### bungee - [BungeeExtension](https://docs.typst.io/spigradle/$SPIGRADLE_VERSION/spigradle/io.typst.spigradle.bungee/-bungee-extension/index.html)

The description of your plugin for a 'bungee.yml'.

About the `bungee.yml`, See [Here](https://www.spigotmc.org/wiki/create-your-first-bungeecord-plugin-proxy-spigotmc/#making-it-load)

<details>
<summary>Groovy Example</summary>

```groovy
bungee {
    description 'A Bungeecord plugin.'
    author 'Me'
    depend 'foo', 'bar'
    softDepend 'soft'
}
```

</details>

<details>
<summary>Kotlin Example</summary>

```kotlin
bungee {
    description = "A Bungeecord plugin."
    author = "Me"
    depend = listOf("SomePlugin")
    softDepend = listOf("SomeSoftPlugin")
}
```

Without [type-safe accessors](https://docs.gradle.org/current/userguide/kotlin_dsl.html#sec:kotlin_using_standard_api):

```kotlin
configure<BungeeExtension> {
    description = "A Bungeecord plugin."
}
```

</details>

## Repository shortcuts

Repository shortcuts are available via `bungeeRepos {}` block inside `repositories {}`:

| Shortcut | URL |
|----------|-----|
| `bungeecord()` | https://oss.sonatype.org/content/repositories/snapshots/ |
| `sonatype()` | https://oss.sonatype.org/content/repositories/snapshots/ |
| `minecraftLibraries()` | https://libraries.minecraft.net/ |
| `jitpack()` | https://jitpack.io/ |

**Example:**

Groovy:
```groovy
repositories {
    mavenCentral()
    bungeeRepos {
        bungeecord()
        minecraftLibraries()
    }
}
```

Kotlin:
```kotlin
repositories {
    mavenCentral()
    bungeeRepos {
        bungeecord()
        minecraftLibraries()
    }
}
```

## Tasks

All tasks support [UP-TO-DATE checks](https://docs.gradle.org/current/userguide/more_about_tasks.html#sec:up_to_date_checks).

**Note:** Debug tasks (server download and run) are currently **Spigot-only**. For BungeeCord, you'll need to set up your own development server.

### detectBungeeMain - [SubclassDetection](https://docs.typst.io/spigradle/$SPIGRADLE_VERSION/spigradle/io.typst.spigradle/-subclass-detection/index.html)

Finds the main class that extends [net.md_5.bungee.api.plugin.Plugin](https://ci.md-5.net/job/BungeeCord/ws/api/target/apidocs/net/md_5/bungee/api/plugin/Plugin.html).

### generateBungeeDescription - [YamlGenerate](https://docs.typst.io/spigradle/$SPIGRADLE_VERSION/spigradle/io.typst.spigradle/-yaml-generate/index.html)

*Depends on: `detectBungeeMain`*

Generates the description file 'bungee.yml'.

## See also

- [The Spigot plugin](spigot_plugin.md)
- [The Nukkit plugin](nukkit_plugin.md)
- [README.md](../README.md)
- [Gradle Kotlin DSL Primer](https://docs.gradle.org/current/userguide/kotlin_dsl.html)
